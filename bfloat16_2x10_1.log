2023-02-10 19:44:42,050 - INFO - Dumping launch arguments.
2023-02-10 19:44:42,050 - INFO - ['bin/exec.py', 'mode=train', 'run.id=bfloat16_2x10_1', 'run.distributed=False', 'data.data_directory=/lambda_stor/data/datascience/cosmic_tagging/', 'framework=torch', 'run.compute_mode=IPU', 'run.minibatch_size=2', 'run.iterations=30', 'run.precision=3', 'hydra/job_logging=disabled']
2023-02-10 19:44:42,051 - INFO - Running Training
2023-02-10 19:44:42,057 - INFO - 

-- CONFIG --
data: 
  aux_file....................: cosmic_tagging_val.h5
  data_directory..............: /lambda_stor/data/datascience/cosmic_tagging/
  data_format.................: channels_first
  downsample..................: 1
  file........................: cosmic_tagging_train.h5
  img_transform...............: False
  synthetic...................: False
framework: 
  distributed_mode............: DDP
  name........................: torch
  sparse......................: False
mode: 
  checkpoint_iteration........: 500
  logging_iteration...........: 1
  name........................: train
  no_summary_images...........: True
  optimizer: 
    gradient_accumulation.....: 1
    learning_rate.............: 0.0003
    loss_balance_scheme.......: focal
    name......................: adam
  quantization_aware..........: False
  summary_iteration...........: 1
  weights_location............: 
network: 
  bias........................: True
  block_concat................: False
  blocks_deepest_layer........: 5
  blocks_final................: 5
  blocks_per_layer............: 2
  bottleneck_deepest..........: 256
  connections.................: concat
  conv_mode...................: conv_2D
  data_format.................: channels_first
  depth.......................: 6
  downsampling................: max_pooling
  filter_size_deepest.........: 5
  growth_rate.................: additive
  n_initial_filters...........: 16
  name........................: uresnet
  normalization...............: batch
  residual....................: True
  upsampling..................: interpolation
  weight_decay................: 0.1
output_dir....................: output/torch/uresnet/bfloat16_2x10_1/
run: 
  aux_iterations..............: 10
  compute_mode................: IPU
  distributed.................: False
  id..........................: bfloat16_2x10_1
  iterations..................: 30
  minibatch_size..............: 2
  precision...................: float16
  profile.....................: False

2023-02-10 19:44:44,986 - INFO - Larcv file prepared
2023-02-10 19:44:45,369 - INFO - Larcv file prepared
2023-02-10 19:44:45,627 - INFO - Total number of trainable parameters in this network: 18382131
2023-02-10 19:44:45.649311: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-10 19:44:45.755147: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 19:44:45.755208: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-02-10 19:44:47.764040: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 19:44:47.764132: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 19:44:47.764950: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-02-10 19:44:51,140 - INFO - No checkpoint file found, restarting from scratch
2023-02-10 19:45:47,985 - INFO - train Step 0 metrics: Average/Non_Bkg_Accuracy: 0.00511, Average/mIoU: 0.000146, loss: 5.65 (0.02 IOs / 5.7 (Step)(s))
2023-02-10 19:46:31,831 - INFO - train Step 1 metrics: Average/Non_Bkg_Accuracy: 0.0129, Average/mIoU: 0.000682, loss: 6.29 (0.046 Img/s / 0.17 IOs / 3.9 (Step)(s))
2023-02-10 19:46:54,991 - INFO - train Step 2 metrics: Average/Non_Bkg_Accuracy: 0.00359, Average/mIoU: 0.000293, loss: 4.92 (0.086 Img/s / 0.036 IOs / 4.0 (Step)(s))
2023-02-10 19:47:58,560 - INFO - train Step 3 metrics: Average/Non_Bkg_Accuracy: 0.00455, Average/mIoU: 0.000592, loss: 6.51 (0.031 Img/s / 0.062 IOs / 4.8 (Step)(s))
2023-02-10 19:48:42,119 - INFO - train Step 4 metrics: Average/Non_Bkg_Accuracy: 0.00324, Average/mIoU: 0.000509, loss: 5.71 (0.046 Img/s / 0.051 IOs / 4.0 (Step)(s))
2023-02-10 19:49:05,407 - INFO - train Step 5 metrics: Average/Non_Bkg_Accuracy: 0.00365, Average/mIoU: 0.000772, loss: 7.28 (0.086 Img/s / 0.024 IOs / 4.7 (Step)(s))
2023-02-10 19:50:08,579 - INFO - train Step 6 metrics: Average/Non_Bkg_Accuracy: 0.0154, Average/mIoU: 0.000851, loss: 5.49 (0.032 Img/s / 0.038 IOs / 4.6 (Step)(s))
2023-02-10 19:51:02,564 - INFO - train Step 7 metrics: Average/Non_Bkg_Accuracy: 0.0136, Average/mIoU: 0.000731, loss: 6.56 (0.037 Img/s / 0.023 IOs / 4.4 (Step)(s))
2023-02-10 19:51:33,972 - INFO - train Step 8 metrics: Average/Non_Bkg_Accuracy: 0.00908, Average/mIoU: 0.000694, loss: 5.54 (0.064 Img/s / 0.035 IOs / 4.8 (Step)(s))
2023-02-10 19:52:07,506 - INFO - train Step 9 metrics: Average/Non_Bkg_Accuracy: 0.0121, Average/mIoU: 0.000767, loss: 5.31 (0.06 Img/s / 0.043 IOs / 4.6 (Step)(s))
2023-02-10 19:52:13,603 - INFO - test Step 10 metrics: Average/Non_Bkg_Accuracy: 0.0064, Average/mIoU: 0.000529, loss: 4.3 (0.33 Img/s)
2023-02-10 19:52:42,500 - INFO - train Step 10 metrics: Average/Non_Bkg_Accuracy: 0.00856, Average/mIoU: 0.0011, loss: 6.98 (0.069 Img/s / 0.025 IOs / 4.8 (Step)(s))
2023-02-10 19:53:14,859 - INFO - train Step 11 metrics: Average/Non_Bkg_Accuracy: 0.0127, Average/mIoU: 0.00115, loss: 5.87 (0.062 Img/s / 0.028 IOs / 4.5 (Step)(s))
2023-02-10 19:53:44,748 - INFO - train Step 12 metrics: Average/Non_Bkg_Accuracy: 0.00388, Average/mIoU: 0.000973, loss: 6.94 (0.067 Img/s / 0.021 IOs / 4.6 (Step)(s))
2023-02-10 19:54:23,446 - INFO - train Step 13 metrics: Average/Non_Bkg_Accuracy: 0.00941, Average/mIoU: 0.000527, loss: 4.95 (0.052 Img/s / 0.052 IOs / 3.9 (Step)(s))
2023-02-10 19:54:50,361 - INFO - train Step 14 metrics: Average/Non_Bkg_Accuracy: 0.0168, Average/mIoU: 0.00101, loss: 5.07 (0.074 Img/s / 0.02 IOs / 4.7 (Step)(s))
2023-02-10 19:55:39,796 - INFO - train Step 15 metrics: Average/Non_Bkg_Accuracy: 0.0115, Average/mIoU: 0.0012, loss: 6.28 (0.04 Img/s / 0.039 IOs / 4.7 (Step)(s))
2023-02-10 19:56:09,512 - INFO - train Step 16 metrics: Average/Non_Bkg_Accuracy: 0.0183, Average/mIoU: 0.00106, loss: 5.4 (0.067 Img/s / 0.02 IOs / 4.8 (Step)(s))
2023-02-10 19:57:06,486 - INFO - train Step 17 metrics: Average/Non_Bkg_Accuracy: 0.00829, Average/mIoU: 0.00126, loss: 6.0 (0.035 Img/s / 0.038 IOs / 4.7 (Step)(s))
2023-02-10 19:57:32,524 - INFO - train Step 18 metrics: Average/Non_Bkg_Accuracy: 0.011, Average/mIoU: 0.00085, loss: 5.74 (0.077 Img/s / 0.027 IOs / 4.7 (Step)(s))
2023-02-10 19:58:29,107 - INFO - train Step 19 metrics: Average/Non_Bkg_Accuracy: 0.0227, Average/mIoU: 0.000661, loss: 4.81 (0.035 Img/s / 0.041 IOs / 4.4 (Step)(s))
2023-02-10 19:58:33,845 - INFO - test Step 20 metrics: Average/Non_Bkg_Accuracy: 0.0113, Average/mIoU: 0.000816, loss: 4.42 (0.42 Img/s)
2023-02-10 19:59:25,057 - INFO - train Step 20 metrics: Average/Non_Bkg_Accuracy: 0.0177, Average/mIoU: 0.000977, loss: 4.85 (0.039 Img/s / 0.033 IOs / 4.4 (Step)(s))
2023-02-10 20:00:44,071 - INFO - train Step 21 metrics: Average/Non_Bkg_Accuracy: 0.0117, Average/mIoU: 0.0013, loss: 5.19 (0.025 Img/s / 0.04 IOs / 4.7 (Step)(s))
2023-02-10 20:01:15,716 - INFO - train Step 22 metrics: Average/Non_Bkg_Accuracy: 0.00759, Average/mIoU: 0.000899, loss: 5.39 (0.063 Img/s / 0.023 IOs / 4.9 (Step)(s))
2023-02-10 20:02:16,791 - INFO - train Step 23 metrics: Average/Non_Bkg_Accuracy: 0.0165, Average/mIoU: 0.00106, loss: 5.02 (0.033 Img/s / 0.045 IOs / 4.5 (Step)(s))
2023-02-10 20:03:22,987 - INFO - train Step 24 metrics: Average/Non_Bkg_Accuracy: 0.00892, Average/mIoU: 0.00117, loss: 5.94 (0.03 Img/s / 0.052 IOs / 4.7 (Step)(s))
2023-02-10 20:04:00,255 - INFO - train Step 25 metrics: Average/Non_Bkg_Accuracy: 0.00626, Average/mIoU: 0.000829, loss: 6.01 (0.054 Img/s / 0.04 IOs / 4.6 (Step)(s))
2023-02-10 20:04:27,786 - INFO - train Step 26 metrics: Average/Non_Bkg_Accuracy: 0.0106, Average/mIoU: 0.00129, loss: 5.12 (0.073 Img/s / 0.023 IOs / 4.8 (Step)(s))
2023-02-10 20:05:21,736 - INFO - train Step 27 metrics: Average/Non_Bkg_Accuracy: 0.0168, Average/mIoU: 0.00134, loss: 5.18 (0.037 Img/s / 0.043 IOs / 4.0 (Step)(s))
2023-02-10 20:06:26,177 - INFO - train Step 28 metrics: Average/Non_Bkg_Accuracy: 0.0107, Average/mIoU: 0.00177, loss: 6.72 (0.031 Img/s / 0.048 IOs / 4.7 (Step)(s))
2023-02-10 20:06:52,538 - INFO - train Step 29 metrics: Average/Non_Bkg_Accuracy: 0.0117, Average/mIoU: 0.00249, loss: 5.96 (0.076 Img/s / 0.038 IOs / 4.7 (Step)(s))
2023-02-10 20:06:52,553 - INFO - Saving run profile information.
2023-02-10 20:06:52,568 - INFO - Total time to batch_process: 1321.4275
2023-02-10 20:06:52,568 - INFO - Total time to batch process except first iteration: 1264.5755, throughput: 0.0459
2023-02-10 20:06:52,568 - INFO - Total time to batch process except first two iterations: 1220.7250, throughput: 0.0459
