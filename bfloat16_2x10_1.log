2023-02-10 18:52:49,536 - INFO - Dumping launch arguments.
2023-02-10 18:52:49,536 - INFO - ['bin/exec.py', 'mode=train', 'run.id=bfloat16_2x10_1', 'run.distributed=False', 'data.data_directory=/lambda_stor/data/datascience/cosmic_tagging/', 'framework=torch', 'run.compute_mode=IPU', 'run.minibatch_size=2', 'run.iterations=10', 'run.precision=3', 'hydra/job_logging=disabled']
2023-02-10 18:52:49,537 - INFO - Running Training
2023-02-10 18:52:49,543 - INFO - 

-- CONFIG --
data: 
  aux_file....................: cosmic_tagging_val.h5
  data_directory..............: /lambda_stor/data/datascience/cosmic_tagging/
  data_format.................: channels_first
  downsample..................: 1
  file........................: cosmic_tagging_train.h5
  img_transform...............: False
  synthetic...................: False
framework: 
  distributed_mode............: DDP
  name........................: torch
  sparse......................: False
mode: 
  checkpoint_iteration........: 500
  logging_iteration...........: 1
  name........................: train
  no_summary_images...........: True
  optimizer: 
    gradient_accumulation.....: 1
    learning_rate.............: 0.0003
    loss_balance_scheme.......: focal
    name......................: adam
  quantization_aware..........: False
  summary_iteration...........: 1
  weights_location............: 
network: 
  bias........................: True
  block_concat................: False
  blocks_deepest_layer........: 5
  blocks_final................: 5
  blocks_per_layer............: 2
  bottleneck_deepest..........: 256
  connections.................: concat
  conv_mode...................: conv_2D
  data_format.................: channels_first
  depth.......................: 6
  downsampling................: max_pooling
  filter_size_deepest.........: 5
  growth_rate.................: additive
  n_initial_filters...........: 16
  name........................: uresnet
  normalization...............: batch
  residual....................: True
  upsampling..................: interpolation
  weight_decay................: 0.1
output_dir....................: output/torch/uresnet/bfloat16_2x10_1/
run: 
  aux_iterations..............: 10
  compute_mode................: IPU
  distributed.................: False
  id..........................: bfloat16_2x10_1
  iterations..................: 10
  minibatch_size..............: 2
  precision...................: float16
  profile.....................: False

2023-02-10 18:52:52,522 - INFO - Larcv file prepared
2023-02-10 18:53:05,000 - INFO - Larcv file prepared
2023-02-10 18:53:05,260 - INFO - Total number of trainable parameters in this network: 18382131
2023-02-10 18:53:05.285309: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-10 18:53:05.391404: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 18:53:05.391466: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-02-10 18:53:07.406628: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 18:53:07.406718: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/graphcore/poplar_sdk/3.1.0/popart-ubuntu_20_04-3.1.0+6824-9c103dc348/lib:/software/graphcore/poplar_sdk/3.1.0/poplar-ubuntu_20_04-3.1.0+6824-9c103dc348/lib
2023-02-10 18:53:07.407467: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-02-10 18:53:10,815 - INFO - No checkpoint file found, restarting from scratch
2023-02-10 18:54:08,717 - INFO - train Step 0 metrics: Average/Non_Bkg_Accuracy: 0.00286, Average/mIoU: 0.000314, loss: 6.24 (0.019 IOs / 5.6 (Step)(s))
2023-02-10 18:54:41,905 - INFO - train Step 1 metrics: Average/Non_Bkg_Accuracy: 0.00433, Average/mIoU: 0.000716, loss: 6.69 (0.06 Img/s / 0.063 IOs / 4.7 (Step)(s))
2023-02-10 18:55:34,919 - INFO - train Step 2 metrics: Average/Non_Bkg_Accuracy: 0.00665, Average/mIoU: 0.000709, loss: 6.8 (0.038 Img/s / 0.06 IOs / 4.7 (Step)(s))
2023-02-10 18:55:57,544 - INFO - train Step 3 metrics: Average/Non_Bkg_Accuracy: 0.00525, Average/mIoU: 0.00069, loss: 7.25 (0.088 Img/s / 0.052 IOs / 4.6 (Step)(s))
2023-02-10 18:56:28,572 - INFO - train Step 4 metrics: Average/Non_Bkg_Accuracy: 0.00285, Average/mIoU: 0.000537, loss: 5.61 (0.064 Img/s / 0.022 IOs / 4.6 (Step)(s))
2023-02-10 18:57:17,931 - INFO - train Step 5 metrics: Average/Non_Bkg_Accuracy: 0.0175, Average/mIoU: 0.000491, loss: 4.8 (0.041 Img/s / 0.056 IOs / 4.6 (Step)(s))
2023-02-10 18:57:52,980 - INFO - train Step 6 metrics: Average/Non_Bkg_Accuracy: 0.0117, Average/mIoU: 0.000497, loss: 5.43 (0.057 Img/s / 0.03 IOs / 4.8 (Step)(s))
2023-02-10 18:58:51,120 - INFO - train Step 7 metrics: Average/Non_Bkg_Accuracy: 0.012, Average/mIoU: 0.00121, loss: 6.07 (0.034 Img/s / 0.063 IOs / 4.8 (Step)(s))
2023-02-10 18:59:44,487 - INFO - train Step 8 metrics: Average/Non_Bkg_Accuracy: 0.00437, Average/mIoU: 0.000653, loss: 6.04 (0.037 Img/s / 0.055 IOs / 4.6 (Step)(s))
2023-02-10 19:00:11,308 - INFO - train Step 9 metrics: Average/Non_Bkg_Accuracy: 0.0162, Average/mIoU: 0.000445, loss: 5.18 (0.075 Img/s / 0.031 IOs / 4.0 (Step)(s))
2023-02-10 19:00:11,326 - INFO - Saving run profile information.
2023-02-10 19:00:11,342 - INFO - Total time to batch_process: 420.5263
2023-02-10 19:00:11,343 - INFO - Total time to batch process except first iteration: 362.6194, throughput: 0.0496
2023-02-10 19:00:11,343 - INFO - Total time to batch process except first two iterations: 329.2778, throughput: 0.0486
